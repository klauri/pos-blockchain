# POS system using blockchain technology

## Definition of POS Block
### Head
1. Index: position of this block in the entire blockchain
2. Timestamp: build time of the current block
3. Previous hash: the hash value of the previous block
4. Proof of Work (POW): proving the correctness of the work generated by the new block 

### Transaction
1. Transaction stream ID: a five-tuple composed of cash register identification, system user ID, transaction time,
transaction serial number, and random number generating the transaction. This element is used to globally
identify the uniqueness of the transaction, as well as to trace the time and location of the transaction and
the participants involved in the transaction
2. Trading time: the specific time of the transaction
3. Trading commodity information: an array that records the identification information of commoditites involved
in the transaction, the price of each commodity, the quantity of each commodity, and the actual sale price, ie. 
quantity multiplied by price of commodity
4. Transaction amount: the total amount generated in a transaction
5. Transaction ID: buyer identification
6. Transaction hash: the hash value of the above transaction information to ensure that transaction information
is not modified

## Building the POS blockchain network
Security networking mechanism of the POS blockchain, depending mainly on CA certificate
- CA Services: They are used to issue trusted digital certificates to cash registers so that these cash registers
can form a blockchain
- POS Certification: This certification contains the POS machine's public key, POS machine information, and
digitial summary information

## POS Blockchain based transaction
**Step 1: Generate transactions and broadcas** <br>
In the POS blockchain network, any node can generate transactions, and each transaction generated by any node will be transferred to other nodes in a manner of broadcasting. Each node needs to maintain a blockchain and can accept transations generated by all nodes and write these transactions into a new block. Typically, each block may have hundreds or thousands of transactions.
**Step 2: Verify transactions and reach a consensus** <br>
Although each node can receive transactions and write them into new blocks, the determination of a node which owns the most realistic transactions requires a consensus among all the nodes in the
network. In our method, the POW is very simple. Each node which records a ledger will obtain the right of veriÔ¨Åcation. It can broadcast the hash information of all transactions to the entire network and compare the information with other nodes.
**Step 3: Broadcast the new block** <br>
The node that can complete the POW is recognized to own the certified new block, and it will broadcast its block to other nodes in the blockchain network.
**Step 4: Add the new block to the blockchain**<br>
Other nodes can confirm whether the transaction contained in this block is valid. After confirming that the transaction has not been duplicated and has a sign of validity, a node can accept the block. At this time the block is officially linked to the blockchain, and the data of the block can no longer be modified. Once all nodes have accepted the block, other blocks which did not finish the POW before become invalid, and each node will re-establish a block and continue the next POW calculation. 

## Data Synchronization Based on Edge Computing
Offline computation at each site will function normally. Once network is back online, the POS blockchain will need to synchronize with POS cloud. The synchronization process requires a node selection from the POS blockchain to the network to be responsible for the work of data synchronization. Here the selected node is called a POS edge computing server. 
Selection from the POS blockchain nodes is done by whichever node first completed the POW before the network comes back online. 

## Inventory Data and Reliability
Inventory can be completed by a separate inventory blockchain that will have up to date data of items in the storeroom. Adding a new item or modifying price will require a new block to be added, and a chronological order of price changes will be preserved. Auditing is completed by simply going back on the blockchain to previous states. Approval can be required before a price change is completed. Any change made by unauthorized owner will not be added to the blockchain. 